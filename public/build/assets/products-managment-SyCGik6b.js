import{r as u,j as t,b as c,L as x}from"./app-CaMeP3M8.js";import{B as m}from"./app-logo-icon-DBycB7GJ.js";import{L as j,I as l}from"./label-DKq46I-6.js";import{A as y}from"./app-layout-VG2RKsF-.js";import{S as b}from"./bookepinglayout-BK5mC3bF.js";/* empty css            */import{D as _}from"./DataGrid-DBRDN6-O.js";import"./index-Sx6bqdWw.js";import"./index-C7M6TDP0.js";import"./heading-Dnm1c98N.js";const v=()=>{const[d,o]=u.useState(null),r=a=>{a.target.files&&a.target.files.length>0&&o(a.target.files[0])},s=async()=>{if(!d){alert("Пожалуйста, выберите файл!");return}const a=new FormData;a.append("file",d);try{const i=await c.post("/products/import",a,{headers:{"Content-Type":"multipart/form-data"}});alert(i.data.message)}catch(i){alert("Ошибка при загрузке файла"),console.error(i)}};return t.jsxs("div",{children:[t.jsx("div",{children:t.jsx(j,{children:"В Excel должны содержать столбцы: name, factory_price_usd, markup_percentage, agent_bonus"})}),t.jsxs("div",{style:{display:"flex"},children:[t.jsx("div",{style:{margin:"5px"},children:t.jsx(l,{type:"file",accept:".xls,.xlsx,.csv",onChange:r})}),t.jsxs("div",{style:{margin:"5px"},children:[" ",t.jsx(m,{onClick:s,children:"Загрузить файл"})]})]})]})},C=[{title:"Управление продукцией",href:"/productsmanagment"}];function A(){const[d,o]=u.useState([]),[r,s]=u.useState({id:0,name:"",factory_price:0,markup_percentage:0,agent_bonus:0}),a=()=>{c.get("/products").then(e=>o(e.data)).catch(e=>console.error("Ошибка при загрузке продуктов:",e))};u.useEffect(()=>{a()},[]);const i=()=>{if(!r.name.trim()||r.factory_price<=0){alert("Введите корректные данные для нового продукта!");return}c.post("/products",r).then(e=>{alert(e.data.message),a(),s({id:0,name:"",factory_price:0,markup_percentage:0,agent_bonus:0})}).catch(e=>console.error("Ошибка при добавлении продукта:",e))},h=e=>{c.delete(`/products/${e}`).then(()=>{o(n=>n.filter(p=>p.id!==e))}).catch(n=>console.error("Ошибка при удалении продукта:",n))},g=e=>{c.put(`/products/${e.id}`,e).then(()=>{o(n=>n.map(p=>p.id===e.id?e:p))}).catch(n=>console.error("Ошибка при редактировании продукта:",n))},f=[{field:"id",headerName:"ID",width:70},{field:"name",headerName:"Наименование",width:200,editable:!0},{field:"factory_price",headerName:"Цена завода",type:"number",width:150,editable:!0},{field:"markup_percentage",headerName:"Наценка (%)",type:"number",width:150,editable:!0},{field:"agent_bonus",headerName:"Бонус агенту",type:"number",width:150,editable:!0},{field:"actions",headerName:"Действия",width:150,renderCell:e=>t.jsx(m,{style:{backgroundColor:"red",color:"white"},onClick:()=>h(e.id),children:"Удалить"})}];return t.jsxs(y,{breadcrumbs:C,children:[t.jsx(x,{title:"Управление продукцией"}),t.jsx(b,{children:t.jsxs("div",{style:{},children:[t.jsx("h2",{children:"Управление продукцией"}),t.jsxs("div",{className:"inputs-container",children:[t.jsx(l,{type:"text",placeholder:"Наименование",value:r.name,onChange:e=>s({...r,name:e.target.value})}),t.jsx(l,{type:"number",placeholder:"Цена завода",value:r.factory_price,onChange:e=>s({...r,factory_price:parseFloat(e.target.value)}),step:"0.01"}),t.jsx(l,{type:"number",placeholder:"Наценка (%)",value:r.markup_percentage,onChange:e=>s({...r,markup_percentage:parseFloat(e.target.value)}),step:"0.01"}),t.jsx(l,{type:"number",placeholder:"Бонус агенту",value:r.agent_bonus,onChange:e=>s({...r,agent_bonus:parseFloat(e.target.value)}),step:"0.01"}),t.jsx(m,{onClick:i,children:"Добавить продукт"})]}),t.jsx("div",{children:t.jsx(v,{})}),t.jsx("div",{className:"dataGrid-container",children:t.jsx(_,{rows:d,columns:f,pageSizeOptions:[25,50,100],initialState:{pagination:{paginationModel:{pageSize:25,page:0}}},pagination:!0,processRowUpdate:e=>(g(e),e)})})]})})]})}export{A as default};
